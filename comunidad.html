<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comunidad - El Basurero</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="icon" href="Imagenes/icono.png" type="image/x-icon">
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <meta name="description" content="El Basurero, tu canal de reacciones en YouTube. Horarios, videos y comunidad.">
    <meta name="keywords" content="El Basurero, reacciones, YouTube, directos, Twitch, MÃ©xico, Argentina, stream, videos, comunidad, pelÃ­culas, series, opiniÃ³n, videoreacciÃ³n">
</head>
<body>
  <div id="header"></div>

<!-- ðŸ”¹ POPUP LOGIN -->
<!-- Popup de login -->
  <div id="loginModal" class="modal">
    <div class="modal-content">
      <h2 id="form-title" class="modal-title">Iniciar SesiÃ³n</h2>
      <form id="loginForm" class="login-form">
        <div class="form-group">
          <input type="email" id="email" placeholder="Correo electrÃ³nico" required>
        </div>
        <div class="form-group" id="username-group" style="display: none;">
          <input type="text" id="username" placeholder="Nombre de usuario (opcional)" maxlength="30">
        </div>
        <div class="form-group">
          <input type="password" id="password" placeholder="ContraseÃ±a" required>
        </div>
        <button type="button" id="actionBtn" class="btn btn-primary">Login</button>
      </form>
      <p class="switch" onclick="toggleForm()">Â¿No tienes cuenta? RegÃ­strate aquÃ­</p>
      <div class="social-login">
        <p>O ingresa con:</p>
        <button class="btn btn-google" onclick="loginGoogle()">
          <img src="Imagenes/google_logo.webp" alt="Google" class="social-icon"> Google
        </button>
        <button class="btn btn-facebook" onclick="loginFacebook()">
          <img src="Imagenes/facebook_logo_2.png" alt="Facebook" class="social-icon"> Facebook
        </button>
      </div>
      <button class="btn btn-close" onclick="cerrarLogin()">Cerrar</button>
    </div>
  </div>

  <main class="container">
    <!-- Chat -->
    <section class="forum">
      <h2>El BasuChat</h2>
      <form id="message-form" class="forum-form">
        <input type="text" id="name" placeholder="Tu nombre" required maxlength="30" />
        <textarea id="message" placeholder="Escribe tu mensaje" required maxlength="500"></textarea>
        <div class="form-actions">
          <button type="submit">Enviar comentario</button>
        </div>
      </form>


      <div id="community-wall" class="messages"></div>
    </section>

    <!-- Calendario -->
    <section class="community-calendar">
  <h2>ðŸŽ‚ CumpleaÃ±os</h2>

  <form id="birthday-form" class="birthday-form">
    <input type="text" id="bday-name" placeholder="Nombre" required maxlength="50" />
    <input type="date" id="bday-date" required />
    <div class="form-actions">
      <button type="submit">Guardar</button>
    </div>
  </form>

  <div class="calendar-wrapper">
    <ul id="birthday-list" class="birthday-list"></ul>

    <div>
      <div class="calendar-controls">
        <button id="prev-month">â—€</button>
        <span id="month-label"></span>
        <button id="next-month">â–¶</button>
      </div>
      <div id="calendar"></div>
    </div>
  </div>
</section>

  </main>

<footer>
    <p>&copy; 2025 El Basurero. Todos los derechos reservados.</p>
    <h3>SÃ­gueme en mis redes</h3>
  <div class="social-links">
    <a href="https://www.twitch.tv/elbasurerochido" target="_blank">
      <img src="Imagenes/twitch_logo.png" alt="Twitch"> Twitch
    </a>
    <a href="https://www.youtube.com/@elbasureroedgar" target="_blank">
      <img src="Imagenes/youtube_logo.png" alt="YouTube"> YouTube
    </a>
    <a href="https://discord.gg/TgAkT7PFt5" target="_blank">
      <img src="Imagenes/discord_logo.png" alt="Discord"> Discord
    </a>
    <a href="https://www.instagram.com/el_basurero_tiviplas" target="_blank">
      <img src="Imagenes/instagram_logo.png" alt="Instagram"> Instagram
    </a>
    <a href="https://www.facebook.com/el.basurero.ti.vi.plas" target="_blank">
      <img src="Imagenes/facebook_logo.png" alt="Facebook"> Facebook
    </a>
    <a href="https://www.patreon.com/cw/ElBasureroTi_Vi_Plas" target="_blank">
      <img src="Imagenes/patreon_logo.png" alt="Patreon"> Patreon
    </a>
  </div>
</footer>

  <!-- Header + comunes -->
  <script src="js/scripts.js"></script>
  <script>
  fetch("header.html")
    .then(response => response.text())
    .then(data => {
      document.getElementById("header").innerHTML = data;
    })
    .catch(error => console.error("Error cargando el header:", error));
</script>

<script type="module">
  import { auth } from "./js/firebase-config.js";
  import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

  // Wrapper: chequea si estÃ¡ logueado
  window.accionProtegida = function(callback) {
    if (auth.currentUser) {
      callback(); // ejecuta acciÃ³n normal
    } else {
      abrirLogin(); // abre popup
    }
  }

  // AcciÃ³n ejemplo
  window.enviarComentario = function() {
    alert("Comentario enviado!");
  }
</script>

// login //
<script type="module">
  import { auth } from "./js/firebase-config.js";
  import { 
    createUserWithEmailAndPassword, 
    signInWithEmailAndPassword, 
    onAuthStateChanged,
    GoogleAuthProvider,
    FacebookAuthProvider,
    signInWithPopup
  } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

  let isLogin = true;

  // Abrir/Cerrar popup
  window.abrirLogin = function() {
    document.getElementById("loginModal").style.display = "flex";
  }
  window.cerrarLogin = function() {
    document.getElementById("loginModal").style.display = "none";
  }

  // Cambiar entre login y registro
  window.toggleForm = function() {
    isLogin = !isLogin;
    document.getElementById("form-title").innerText = isLogin ? "Iniciar SesiÃ³n" : "Registrarse";
    document.getElementById("actionBtn").innerText = isLogin ? "Login" : "Registrarse";
    document.querySelector(".switch").innerText = isLogin 
      ? "Â¿No tienes cuenta? RegÃ­strate aquÃ­" 
      : "Â¿Ya tienes cuenta? Inicia sesiÃ³n aquÃ­";
  }

  // AcciÃ³n principal (login o registro con email/pass)
  document.getElementById("actionBtn").addEventListener("click", () => {
    const email = document.getElementById("email").value;
    const pass = document.getElementById("password").value;

    if (isLogin) {
      signInWithEmailAndPassword(auth, email, pass)
        .then(userCredential => {
          alert("Bienvenido " + userCredential.user.email);
          cerrarLogin();
        })
        .catch(error => alert(error.message));
    } else {
      createUserWithEmailAndPassword(auth, email, pass)
        .then(userCredential => {
          alert("Usuario registrado: " + userCredential.user.email);
          cerrarLogin();
        })
        .catch(error => alert(error.message));
    }
  });

  // ðŸ”¹ Login con Google
  window.loginGoogle = function() {
    const provider = new GoogleAuthProvider();
    signInWithPopup(auth, provider)
      .then(result => {
        alert("Bienvenido " + result.user.displayName);
        cerrarLogin();
      })
      .catch(error => alert(error.message));
  }

  // ðŸ”¹ Login con Facebook
  window.loginFacebook = function() {
    const provider = new FacebookAuthProvider();
    signInWithPopup(auth, provider)
      .then(result => {
        alert("Bienvenido " + result.user.displayName);
        cerrarLogin();
      })
      .catch(error => alert(error.message));
  }

  // ðŸ”¹ Estado de sesiÃ³n
  onAuthStateChanged(auth, user => {
    if (user) {
      console.log("Usuario conectado:", user.email);
    } else {
      console.log("No logueado");
    }
  });
</script>


  <!-- Comunidad (solo una vez y como mÃ³dulo) -->
  <script type="module" src="js/community.js"></script>
</body>
</html>